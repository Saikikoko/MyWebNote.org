(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{239:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h2",{attrs:{id:"nginx学习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx学习","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx学习")]),t._v(" "),a("h3",{attrs:{id:"初始nginx和环境准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始nginx和环境准备","aria-hidden":"true"}},[t._v("#")]),t._v(" 初始Nginx和环境准备")]),t._v(" "),a("blockquote",[a("p",[t._v('"Nginx是一款轻量级的HTTP服务器，采用事件驱动的异步非阻塞处理方式框架，这让其具有极好的IO性能，时常用于服务端的反向代理和负载均衡。"')])]),t._v(" "),a("p",[t._v("环境：阿里云ECS")]),t._v(" "),a("p",[a("strong",[t._v("使用yum安装必要程序")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("yum -y install gcc gcc-c++ autoconf pcre-devel make automake\nyum -y install wget httpd-tools vim\n")])])]),a("ol",[a("li",[a("p",[t._v("在根路径下新建一个"),a("code",[t._v("Nginx")]),t._v("的文件夹")])]),t._v(" "),a("li",[a("p",[t._v("在"),a("code",[t._v("Nginx")]),t._v("文件夹下再另外建立"),a("code",[t._v("app")]),t._v(","),a("code",[t._v("backup")]),t._v(","),a("code",[t._v("download")]),t._v(","),a("code",[t._v("logs")]),t._v(","),a("code",[t._v("work")]),t._v("文件夹")])])]),t._v(" "),a("h3",{attrs:{id:"nginx的快速搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx的快速搭建","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx的快速搭建")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("查看yum是否已经存在，如果出现一长串列表说明yum源是存在的")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("yum list | grep nginx\n")])])])]),t._v(" "),a("li",[a("p",[t._v("默认yum是1.1.12版本，可以自己配置yum的源，下面是官网提供的源配置选项")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("[nginx]\nname=nginx repo\nbaseurl=http://nginx.org/packages/OS/OSRELEASE/$basearch/\ngpgcheck=0\nenabled=1\n")])])])]),t._v(" "),a("li",[a("p",[t._v("复制以上代码，在终端输入")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("vim /etc/yum.repos.d/nginx.repo\n")])])])]),t._v(" "),a("li",[a("p",[t._v("将以上代码复制进去，然后修改"),a("code",[t._v("baseurl")]),t._v("选项(主要是修改对应的操作系统和版本号)")]),t._v(" "),a("div",{staticClass:"language-vim extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vim"}},[a("code",[t._v("baseurl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("org"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("packages"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("centos"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("$basearch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("退出保存文件后，使用yum命令进行安装")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("yum install nginx\n")])])])]),t._v(" "),a("li",[a("p",[t._v("安装完成后使用命令查看版本号，如果出现对应的版本号，则说明安装成功")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("nginx -v\n")])])]),a("p",[a("img",{attrs:{src:"C:%5CUsers%5Cshengbiao%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1549118415777.png",alt:"1549118415777"}})])])]),t._v(" "),a("h3",{attrs:{id:"nginx基本配置文件详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx基本配置文件详解","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx基本配置文件详解")]),t._v(" "),a("p",[a("strong",[t._v("查看Nginx的安装目录")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("rpm -ql nginx\n")])])]),a("p",[a("strong",[t._v("nginx.conf文件详解")])]),t._v(" "),a("p",[t._v("nginx.conf文件是Nginx总配置文件，使用以下命令打开")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd /etc/nginx\nvim nginx.conf\n")])])]),a("p",[t._v("下面是文件的详细注释：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("#运行用户，默认即是nginx，可以不进行设置\nuser  nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n#Nginx进程，一般设置为和"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CPU")]),t._v("核数一样\nworker_processes  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   \n#错误日志存放目录\nerror_log  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log warn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n#进程pid存放位置\npid        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nevents "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    worker_connections  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" # 单个后台进程的最大并发数\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nhttp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    include       "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("types"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   #文件扩展名与类型映射表\n    default_type  application"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("octet"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  #默认文件类型\n    #设置日志模式\n    log_format  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$remote_addr - $remote_user [$time_local] \"$request\" '")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$status $body_bytes_sent \"$http_referer\" '")]),t._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'"$http_user_agent" "$http_x_forwarded_for"\'')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    access_log  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("access"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log  main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   #nginx访问日志存放位置\n    sendfile        on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   #开启高效传输模式\n    #tcp_nopush     on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    #减少网络报文段的数量\n    keepalive_timeout  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  #保持连接的时间，也叫超时时间\n    #gzip  on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  #开启gzip压缩\n    include "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*.conf; #包含的子配置项位置和文件\n")])])])]),a("p",[a("strong",[t._v("/etc/nginx/conf.d/*.conf目录下"),a("code",[t._v("\\*conf")]),t._v("类型文件配置项详解")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd /ect/nginx/conf.d\nvim default.conf\n")])])]),a("p",[t._v("该目录下，一个文件代表一个虚拟主机")]),t._v(" "),a("p",[t._v("默认"),a("code",[t._v("default.conf")]),t._v("文件讲解")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   #配置监听端口\n    server_name  localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//配置域名")]),t._v("\n    #charset koi8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     \n    #access_log  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("access"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log  main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        root   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     #服务默认启动目录\n        index  index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    #默认访问文件\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    #error_page  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),t._v("              "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404.")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   # 配置"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),t._v("页面\n    # redirect server error pages to the "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" page "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html\n    #\n    error_page   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("502")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("503")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("504")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   #错误状态码的显示页面，配置后需要重启\n    location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        root   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    # proxy the "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PHP")]),t._v(" scripts to Apache listening on "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    #\n    #location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" \\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    #    proxy_pass   http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    #"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    # pass the "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PHP")]),t._v(" scripts to FastCGI server listening on "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9000")]),t._v("\n    #\n    #location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" \\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    #    root           html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    #    fastcgi_pass   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    #    fastcgi_index  index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    #    fastcgi_param  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SCRIPT_FILENAME")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("scripts$fastcgi_script_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    #    include        fastcgi_params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    #"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    # deny access to "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("htaccess files"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" Apache's document root\n    # concurs "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" nginx's one\n    #\n    #location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("\\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ht "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    #    deny  all"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    #"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"nginx服务启动、停止、重启"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx服务启动、停止、重启","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx服务启动、停止、重启")]),t._v(" "),a("p",[a("strong",[t._v("启动Nginx服务：")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("nginx直接启动")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("nginx\n")])])])]),t._v(" "),a("li",[a("p",[t._v("使用Linux命令启动")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("systemctl start nginx.service\n")])])])])]),t._v(" "),a("p",[a("strong",[t._v("查看服务：")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ps aux | grep nginx\n")])])]),a("p",[a("img",{attrs:{src:"C:%5CUsers%5Cshengbiao%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1549119968809.png",alt:"1549119968809"}})]),t._v(" "),a("p",[t._v("如图显示则说明，nginx服务启动成功")]),t._v(" "),a("p",[a("strong",[t._v("停止Nginx服务：")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("立即停止服务，无论进程是否在工作，都直接关闭服务")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("nginx -s stop\n")])])])]),t._v(" "),a("li",[a("p",[t._v("从容停止服务，等待进程完成工作后，停止服务")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("nginx -s quit\n")])])])]),t._v(" "),a("li",[a("p",[t._v("killall杀死所有进程")])]),t._v(" "),a("li",[a("p",[t._v("systemctl停止")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("systemctl stop nginx.service\n")])])])])]),t._v(" "),a("p",[a("strong",[t._v("重启nginx服务：")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("systemctl restart nginx.service\n")])])]),a("p",[a("strong",[t._v("重新载入配置文件")])]),t._v(" "),a("p",[t._v("在重新编写或者修改Nginx的配置文件后，都需要作以下重载")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("nginx -s reload\n")])])]),a("p",[a("strong",[t._v("查看端口号")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("netstat -tlnp\n")])])]),a("p",[t._v("该命令可以查看端口的占用情况")]),t._v(" "),a("h3",{attrs:{id:"_404页面设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_404页面设置","aria-hidden":"true"}},[t._v("#")]),t._v(" 404页面设置")]),t._v(" "),a("ol",[a("li",[t._v("编辑配置文件"),a("code",[t._v("/etc/nginx/conf.d/default.conf")])])]),t._v(" "),a("div",{staticClass:"language-conf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("error_page   404  /404.html;\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("编写404页面")])]),t._v(" "),a("li",[a("p",[t._v("首先进入"),a("code",[t._v("/usr/share/nginx/html")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("vim 404.html")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token doctype"}},[t._v("<!DOCTYPE html>")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("utf-8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("404"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("style")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token style language-css"}},[t._v("\n  "),a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("width")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 25%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("margin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" auto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("style")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("404页面找不到了"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("重启nginx服务")])])]),t._v(" "),a("h3",{attrs:{id:"nginx访问权限设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx访问权限设置","aria-hidden":"true"}},[t._v("#")]),t._v(" nginx访问权限设置")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v(" location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        allow  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("45.76")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".202")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".231")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        deny   all"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("该配置表示除了"),a("code",[t._v("45.76.202.231")]),t._v("，其他的ip都不能访问该服务器的任意目录，allow和deny谁在前谁的优先级高")]),t._v(" "),a("h4",{attrs:{id:"精确比配-访问权限配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#精确比配-访问权限配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 精确比配"),a("code",[t._v("=")]),t._v("访问权限配置")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\nallow all"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nlocation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\ndeny all"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("设置完后，该网站"),a("code",[t._v("img")]),t._v("目录所有用户都可以访问，"),a("code",[t._v("admin")]),t._v("目录所有用户都不可以访问")]),t._v(" "),a("h4",{attrs:{id:"正则（模糊）匹配-访问权限配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#正则（模糊）匹配-访问权限配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 正则（模糊）匹配"),a("code",[t._v("~")]),t._v("访问权限配置")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v("\\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    deny all"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("不能访问"),a("code",[t._v(".php")]),t._v("文件")]),t._v(" "),a("h3",{attrs:{id:"nginx设置虚拟主机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx设置虚拟主机","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx设置虚拟主机")]),t._v(" "),a("h4",{attrs:{id:"基于端口号配置虚拟主机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于端口号配置虚拟主机","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("基于端口号配置虚拟主机")])]),t._v(" "),a("ol",[a("li",[a("code",[t._v("etc/nginx/conf.d/")]),t._v("目录下新建配置文件"),a("code",[t._v("3000.conf")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        server_name localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        root "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html3000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        index index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("在"),a("code",[t._v("usr/share/nginx/html/html3000/")]),t._v("目录下新建"),a("code",[t._v("index.html")]),t._v("文件")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    Welcome to port 3000\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("重启服务")])])]),t._v(" "),a("h4",{attrs:{id:"基于ip设置虚拟主机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于ip设置虚拟主机","aria-hidden":"true"}},[t._v("#")]),t._v(" 基于ip设置虚拟主机")]),t._v(" "),a("p",[t._v("只需改变server选项中的"),a("code",[t._v("server_name")]),t._v("即可")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        server_name "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("112.74")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".164")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".244")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        root "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html8001"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        index index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"使用域名设置虚拟主机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用域名设置虚拟主机","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用域名设置虚拟主机")]),t._v(" "),a("p",[t._v("和ip类似修改server选项中的"),a("code",[t._v("server_name")]),t._v("即可")]),t._v(" "),a("h3",{attrs:{id:"nginx反向代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx反向代理","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx反向代理")]),t._v(" "),a("ul",[a("li",[t._v("安全 隐藏真实服务器")]),t._v(" "),a("li",[t._v("负载均衡")])]),t._v(" "),a("p",[t._v("修改配置文件"),a("code",[t._v("3000.conf")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        server_name blog"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("saiki"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xyz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n               proxy_pass http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("saiki"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xyz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("设置完以后，用户访问"),a("code",[t._v("http://blog.saiki.xyz")]),t._v("，则会访问"),a("code",[t._v("http://saiki.xyz")])]),t._v(" "),a("ul",[a("li",[t._v("proxy_set_header :在将客户端请求发送给后端服务器之前，更改来自客户端的请求头信息。")]),t._v(" "),a("li",[t._v("proxy_connect_timeout:配置Nginx与后端代理服务器尝试建立连接的超时时间。")]),t._v(" "),a("li",[t._v("proxy_read_timeout : 配置Nginx向后端服务器组发出read请求后，等待相应的超时时间。")]),t._v(" "),a("li",[t._v("proxy_send_timeout：配置Nginx向后端服务器组发出write请求后，等待相应的超时时间。")]),t._v(" "),a("li",[t._v("proxy_redirect :用于修改后端服务器返回的响应头中的Location和Refresh。")])]),t._v(" "),a("h3",{attrs:{id:"nginx适配pc或移动设备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx适配pc或移动设备","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx适配PC或移动设备")]),t._v(" "),a("p",[t._v("通过变量"),a("code",[t._v("$http_user_agent")]),t._v("获取"),a("code",[t._v("userAgent")]),t._v("，判断用户目前处于移动端还是pc端")]),t._v(" "),a("p",[t._v("操作步骤如下：")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("在"),a("code",[t._v("/usr/share/nginx/")]),t._v("目录下新建两个文件夹，分别为：pc和mobile目录")]),t._v(" "),a("div",{staticClass:"language-vim extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vim"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("cd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("share"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx\nmkdir "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pc")]),t._v("\nmkdir mobile\n")])])])]),t._v(" "),a("li",[a("p",[t._v("在pc和miblic目录下，新建两个index.html文件，文件里下面内容")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("I am pc!"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("I am mobile!"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("进入"),a("code",[t._v("etc/nginx/conf.d")]),t._v("目录下，修改3000.conf文件，改为下面的形式:")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     server_name blog"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("saiki"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("xyz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      root "),a("span",{pre:!0,attrs:{class:"token string regex"}},[t._v("/usr/")]),t._v("share"),a("span",{pre:!0,attrs:{class:"token string regex"}},[t._v("/nginx/")]),t._v("pc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),t._v("http_user_agent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(Android|webOS|iPhone|iPod|BlackBerry)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         root "),a("span",{pre:!0,attrs:{class:"token string regex"}},[t._v("/usr/")]),t._v("share"),a("span",{pre:!0,attrs:{class:"token string regex"}},[t._v("/nginx/")]),t._v("mobile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      index index"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"nginx的gzip压缩配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx的gzip压缩配置","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx的Gzip压缩配置")]),t._v(" "),a("p",[a("strong",[t._v("gzip的配置项")])]),t._v(" "),a("p",[t._v("Nginx提供了专门的gzip模块，并且模块中的指令非常丰富。")]),t._v(" "),a("ul",[a("li",[t._v("gzip : 该指令用于开启或 关闭gzip模块。")]),t._v(" "),a("li",[t._v("gzip_buffers : 设置系统获取几个单位的缓存用于存储gzip的压缩结果数据流。")]),t._v(" "),a("li",[t._v("gzip_comp_level : gzip压缩比，压缩级别是1-9，1的压缩级别最低，9的压缩级别最高。压缩级别越高压缩率越大，压缩时间越长。")]),t._v(" "),a("li",[t._v("gzip_disable : 可以通过该指令对一些特定的User-Agent不使用压缩功能。")]),t._v(" "),a("li",[t._v("gzip_min_length:设置允许压缩的页面最小字节数，页面字节数从相应消息头的Content-length中进行获取。")]),t._v(" "),a("li",[t._v("gzip_http_version：识别HTTP协议版本，其值可以是1.1.或1.0.")]),t._v(" "),a("li",[t._v("gzip_proxied : 用于设置启用或禁用从代理服务器上收到相应内容gzip压缩。")]),t._v(" "),a("li",[t._v("gzip_vary : 用于在响应消息头中添加Vary：Accept-Encoding,使代理服务器根据请求头中的Accept-Encoding识别是否启用gzip压缩。")])]),t._v(" "),a("p",[a("strong",[t._v("gzip最简单的配置")])]),t._v(" "),a("div",{staticClass:"language-applescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-applescript"}},[a("code",[t._v("http "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   .....\n    gzip "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(";\n    gzip_types "),a("span",{pre:!0,attrs:{class:"token class builtin"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("plain "),a("span",{pre:!0,attrs:{class:"token class builtin"}},[t._v("application")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("javascript "),a("span",{pre:!0,attrs:{class:"token class builtin"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("css;\n   .....\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("code",[t._v("gzip on")]),t._v("是启用gizp模块，下面的一行是用于在客户端访问网页时，对文本、JavaScript 和CSS文件进行压缩输出。")])])}],!1,null,null,null);s.default=e.exports}}]);