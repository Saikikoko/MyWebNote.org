<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>localStorage-webWorker-cache | 前端学习</title>
    <meta name="description" content="就算没有契机，时间也会将人的情感变为回忆。伤痛像结了疤一样被填满，并在没人注意到的地方脱落，人就是这样不断前进的">
    <link rel="shortcut icon" href="/MyWebNote.org/icons8-iron-man-24.png">
    
    <link rel="preload" href="/MyWebNote.org/assets/css/0.styles.f56ec604.css" as="style"><link rel="preload" href="/MyWebNote.org/assets/js/app.f2fe0c7f.js" as="script"><link rel="preload" href="/MyWebNote.org/assets/js/25.1949da3c.js" as="script"><link rel="prefetch" href="/MyWebNote.org/assets/js/10.c691ac73.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/100.e2d8a291.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/101.c3cc8e91.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/102.3f61dfa8.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/11.34a31027.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/12.f03591bd.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/13.103c0c59.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/14.fee47807.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/15.94e0bea6.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/16.f2626726.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/17.1a1750fc.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/18.a6cdaaff.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/19.ca2dc743.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/2.a9293c86.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/20.75a11188.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/21.f3790a9b.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/22.e635d85a.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/23.4e27da32.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/24.53112e04.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/26.255b732c.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/27.15d181af.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/28.6438a2ee.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/29.cef785fb.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/3.c6656e0d.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/30.cc18f03f.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/31.d00bf168.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/32.c76aad01.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/33.20acdaf3.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/34.de07c572.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/35.b9e50aef.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/36.fa4b82ff.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/37.c1c503b7.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/38.f6b7b50c.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/39.3f66e672.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/4.94f2c0da.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/40.2e8cdae5.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/41.ecc6b261.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/42.1de39536.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/43.e5ac39a4.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/44.37f62fb3.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/45.de839086.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/46.3dcca0d7.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/47.131ffc4b.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/48.d5952efd.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/49.2a4c4b2a.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/5.5c2f8b20.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/50.55478880.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/51.35632ed1.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/52.30004d26.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/53.4e585a6b.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/54.60d59298.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/55.ffec2acd.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/56.98e755c0.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/57.8e2cb818.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/58.404ba7e4.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/59.a3e93dcf.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/6.e2d4d96a.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/60.0cfe8778.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/61.48ab2616.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/62.44f735ea.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/63.0bfc6f0f.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/64.7785c0e5.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/65.b0c92212.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/66.d61e758d.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/67.fe08374f.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/68.787475c6.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/69.ca681a6c.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/7.6ea3b354.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/70.9e19ac99.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/71.304e5946.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/72.cc9adc1c.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/73.5d6e8cfa.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/74.48b5b8da.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/75.ae563bbf.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/76.5f05336a.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/77.38705786.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/78.3c9b2f38.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/79.b39e10db.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/8.1c994733.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/80.7933b8a9.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/81.17c4e023.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/82.ff8a25ed.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/83.8ff75adb.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/84.29d7cb9e.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/85.9a3b7936.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/86.88d88d3d.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/87.c9311269.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/88.bb4db4ce.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/89.b71072b5.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/9.74f2cd64.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/90.59939a3b.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/91.6b2d9529.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/92.3452ed84.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/93.5a1c587a.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/94.9f285282.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/95.e96ceb1b.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/96.44b7f063.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/97.03ff7ad0.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/98.1e915b70.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/99.a3e97b24.js">
    <link rel="stylesheet" href="/MyWebNote.org/assets/css/0.styles.f56ec604.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/MyWebNote.org/" class="home-link router-link-active"><!----> <span class="site-name">前端学习</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/MyWebNote.org/note/" class="nav-link router-link-active">前端笔记</a></div><div class="nav-item"><a href="http://blog.saiki.xyz/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/Saikikoko/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/MyWebNote.org/note/" class="nav-link router-link-active">前端笔记</a></div><div class="nav-item"><a href="http://blog.saiki.xyz/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/Saikikoko/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>HTML/CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS3</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>H5</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/MyWebNote.org/note/H5/01-HTML5拖拽.html" class="sidebar-link">HTML5拖拽</a></li><li><a href="/MyWebNote.org/note/H5/02-arrayBuffer.html" class="sidebar-link">元数据处理</a></li><li><a href="/MyWebNote.org/note/H5/03-新增方法和历史管理.html" class="sidebar-link">新增方法和历史管理</a></li><li><a href="/MyWebNote.org/note/H5/04-localStorage-webWorker-cache.html" class="active sidebar-link">localStorage-webWorker-cache</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/H5/04-localStorage-webWorker-cache.html#localstorage-webworker-cache" class="sidebar-link">localStorage-webWorker-cache</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/H5/04-localStorage-webWorker-cache.html#localstorage、sessionstorage" class="sidebar-link">localStorage、sessionStorage</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/H5/04-localStorage-webWorker-cache.html#webworker" class="sidebar-link">webworker</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/H5/04-localStorage-webWorker-cache.html#sse事件推送" class="sidebar-link">SSE事件推送</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/H5/04-localStorage-webWorker-cache.html#离线存储" class="sidebar-link">离线存储</a></li></ul></li></ul></li><li><a href="/MyWebNote.org/note/H5/05-Canvas.html" class="sidebar-link">Canvas</a></li><li><a href="/MyWebNote.org/note/H5/06-H5中的数据处理.html" class="sidebar-link">H5中的数据处理</a></li><li><a href="/MyWebNote.org/note/H5/07-ajax数据交互.html" class="sidebar-link">ajax数据交互</a></li><li><a href="/MyWebNote.org/note/H5/08-H5文件下载和上传.html" class="sidebar-link">H5文件下载和上传</a></li><li><a href="/MyWebNote.org/note/H5/09-移动端适配.html" class="sidebar-link">移动端适配</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>nodejs</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="localstorage-webworker-cache"><a href="#localstorage-webworker-cache" aria-hidden="true" class="header-anchor">#</a> localStorage-webWorker-cache</h2> <h3 id="localstorage、sessionstorage"><a href="#localstorage、sessionstorage" aria-hidden="true" class="header-anchor">#</a> localStorage、sessionStorage</h3> <p>和cookie对比：</p> <ul><li>更快速、更安全</li> <li>存储量更大，cookie只能存储5kb大小的数据，localstorage可以存储5mb大小的数据</li> <li>本地存储，相比cookie，不需要封装，直拿直用</li></ul> <p><strong>localStorage 和 sessionStorage区别：</strong></p> <ul><li>localStorage - 用于长久保存整个网站的数据，保存的数据没有过期时间，直到手动去除</li> <li>sessionStorage - 用于临时保存同一窗口(或标签页)的数据，在关闭窗口或标签页之后将会删除这些数据</li></ul> <h4 id="存储数据"><a href="#存储数据" aria-hidden="true" class="header-anchor">#</a> 存储数据</h4> <p>方式一：</p> <p><code>localStorage.xxxx =</code>直接<code>.</code>操作赋值，得到<code>xxx:</code>的键值对</p> <p>方式二：</p> <p><code>localStorage.setItem(key,value)</code></p> <h4 id="获取数据"><a href="#获取数据" aria-hidden="true" class="header-anchor">#</a> 获取数据</h4> <p><code>localStorage.getItem(key)</code></p> <h4 id="删除数据"><a href="#删除数据" aria-hidden="true" class="header-anchor">#</a> 删除数据</h4> <ul><li><code>localStorage.removeItem(key)</code></li> <li><code>localStorage.clear()</code></li></ul> <h4 id="得到某个索引的key"><a href="#得到某个索引的key" aria-hidden="true" class="header-anchor">#</a> 得到某个索引的key</h4> <p><code>localStorage.key(index)</code></p> <p><code>window.localstorage.getItem</code>获取</p> <p><code>window.localstorage.setItem</code>设置</p> <p><code>window.localstorage.removeItem</code>删除</p> <h3 id="webworker"><a href="#webworker" aria-hidden="true" class="header-anchor">#</a> webworker</h3> <p>HTML5中实现多线程的方法，当页面存在耗费CPU的计算任务，可以使用该对象开启一个多线程，用户不用等脚本执行完，即可对页面进行操作</p> <h4 id="检查浏览器是否支持webworker"><a href="#检查浏览器是否支持webworker" aria-hidden="true" class="header-anchor">#</a> 检查浏览器是否支持webworker</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>Worker<span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// 是的! Web worker 支持!</span>
    <span class="token comment">// 一些代码.....</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span>
<span class="token punctuation">{</span>
    <span class="token comment">//抱歉! Web Worker 不支持 </span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="开启多线程"><a href="#开启多线程" aria-hidden="true" class="header-anchor">#</a> 开启多线程</h4> <p><code>new Worker(web worker文件)</code>用于新建<code>web worker</code>对象，并运行参数中的文件</p> <p>其他一些重要的api：</p> <ul><li><code>onmessage</code>该事件用于接收消息，消息挂载在事件对象<code>e.data</code>上</li> <li><code>postMessage(data)</code>用于发送消息</li> <li><code>terminate()</code>当我们创建 web worker 对象后，它会继续监听消息（即使在外部脚本完成之后）直到其被终止为止，该方法用于终止<code>web worker</code>释放资源</li></ul> <h5 id="编写一个work-js文件"><a href="#编写一个work-js文件" aria-hidden="true" class="header-anchor">#</a> 编写一个<code>work.js</code>文件</h5> <div class="language-js extra-class"><pre class="language-js"><code>self<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>e<span class="token punctuation">.</span>data<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        str <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    self<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//self代表调用work.js的web worker对象</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="html文件"><a href="#html文件" aria-hidden="true" class="header-anchor">#</a> HTML文件</h5> <div class="language-HTML extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
    document<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'work:'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> w <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token string">'work.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        w<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//向work.js发送数据</span>
        
        console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'work:'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        w<span class="token punctuation">.</span><span class="token function">terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
    <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="sse事件推送"><a href="#sse事件推送" aria-hidden="true" class="header-anchor">#</a> SSE事件推送</h3> <p><code>new EventSource(url)</code></p> <p>js:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> souce <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span><span class="token string">'./sse.php'</span><span class="token punctuation">)</span>
source<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    box<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> e<span class="token punctuation">.</span>data <span class="token operator">+</span> <span class="token string">'\n'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>php:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Content-Type:text/event-stream'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Cache-control:no-cache'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$arr</span> <span class="token operator">=</span> <span class="token function">json_encode</span><span class="token punctuation">(</span>
	<span class="token keyword">array</span><span class="token punctuation">(</span>
    	<span class="token keyword">array</span><span class="token punctuation">(</span>
        	<span class="token single-quoted-string string">'name'</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token single-quoted-string string">'goudan'</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">array</span><span class="token punctuation">(</span>
        	<span class="token single-quoted-string string">'name'</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token single-quoted-string string">'ergou'</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token single-quoted-string string">'data:{$arr}\n\n'</span><span class="token punctuation">;</span>
<span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h3 id="离线存储"><a href="#离线存储" aria-hidden="true" class="header-anchor">#</a> 离线存储</h3> <h4 id="cache-manifest-基础"><a href="#cache-manifest-基础" aria-hidden="true" class="header-anchor">#</a> Cache Manifest 基础</h4> <p>如需启用应用程序缓存，请在文档的html标签中包含 manifest 属性：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE HTML&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">manifest</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>demo.appcache<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>每个指定了 manifest 的页面在用户对其访问时都会被缓存。如果未指定 manifest 属性，则页面不会被缓存（除非在 manifest 文件中直接指定了该页面）。</p> <p>manifest 文件的建议的文件扩展名是：&quot;.appcache&quot;。</p> <p><img src="http://www.runoob.com/images/lamp.gif" alt="Remark"> 请注意，manifest 文件需要配置正确的 MIME-type，即 &quot;text/cache-manifest&quot;。</p> <p><strong>必须在 web 服务器上进行配置：</strong></p> <p>在apache目录下的httpd.conf文件里加上<code>AddType text/cache-manifest .appcache</code>(<code>.appcache</code>是缓存文件的后缀，可以自己命名)</p> <h4 id="manifest-文件"><a href="#manifest-文件" aria-hidden="true" class="header-anchor">#</a> Manifest 文件</h4> <p>manifest 文件是简单的文本文件，它告知浏览器被缓存的内容（以及不缓存的内容）</p> <p>创建一个后缀名为<code>.appcache</code>的文件</p> <ol><li><p>先写CACHE MANIFEST  在此标题下列出的文件将在首次下载后进行缓存</p></li> <li><p>NETWORK 在此标题下列出的文件需要与服务器的连接，且不会被缓存</p> <div class="language- extra-class"><pre class="language-text"><code>CACHE MANIFEST
# version 2018-06-22 00:34 1.1.4

CACHE:
img/1.jpg
img/2.jpg



NETWORK:
*
</code></pre></div></li></ol> <h4 id="更新缓存"><a href="#更新缓存" aria-hidden="true" class="header-anchor">#</a> 更新缓存</h4> <p>一旦应用被缓存，它就会保持缓存直到发生下列情况：</p> <ul><li>用户清空浏览器缓存</li> <li>manifest 文件被修改（参阅下面的提示）</li> <li>由程序来更新应用缓存</li></ul></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/MyWebNote.org/note/H5/03-新增方法和历史管理.html" class="prev">
          新增方法和历史管理
        </a></span> <span class="next"><a href="/MyWebNote.org/note/H5/05-Canvas.html">
          Canvas
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/MyWebNote.org/assets/js/app.f2fe0c7f.js" defer></script><script src="/MyWebNote.org/assets/js/25.1949da3c.js" defer></script>
  </body>
</html>
