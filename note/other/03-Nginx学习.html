<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nginx学习 | 前端学习</title>
    <meta name="description" content="就算没有契机，时间也会将人的情感变为回忆。伤痛像结了疤一样被填满，并在没人注意到的地方脱落，人就是这样不断前进的">
    <link rel="shortcut icon" href="/MyWebNote.org/icons8-iron-man-24.png">
    
    <link rel="preload" href="/MyWebNote.org/assets/css/0.styles.f56ec604.css" as="style"><link rel="preload" href="/MyWebNote.org/assets/js/app.f2fe0c7f.js" as="script"><link rel="preload" href="/MyWebNote.org/assets/js/98.1e915b70.js" as="script"><link rel="prefetch" href="/MyWebNote.org/assets/js/10.c691ac73.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/100.e2d8a291.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/101.c3cc8e91.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/102.3f61dfa8.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/11.34a31027.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/12.f03591bd.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/13.103c0c59.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/14.fee47807.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/15.94e0bea6.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/16.f2626726.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/17.1a1750fc.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/18.a6cdaaff.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/19.ca2dc743.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/2.a9293c86.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/20.75a11188.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/21.f3790a9b.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/22.e635d85a.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/23.4e27da32.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/24.53112e04.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/25.1949da3c.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/26.255b732c.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/27.15d181af.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/28.6438a2ee.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/29.cef785fb.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/3.c6656e0d.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/30.cc18f03f.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/31.d00bf168.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/32.c76aad01.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/33.20acdaf3.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/34.de07c572.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/35.b9e50aef.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/36.fa4b82ff.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/37.c1c503b7.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/38.f6b7b50c.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/39.3f66e672.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/4.94f2c0da.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/40.2e8cdae5.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/41.ecc6b261.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/42.1de39536.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/43.e5ac39a4.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/44.37f62fb3.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/45.de839086.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/46.3dcca0d7.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/47.131ffc4b.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/48.d5952efd.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/49.2a4c4b2a.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/5.5c2f8b20.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/50.55478880.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/51.35632ed1.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/52.30004d26.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/53.4e585a6b.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/54.60d59298.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/55.ffec2acd.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/56.98e755c0.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/57.8e2cb818.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/58.404ba7e4.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/59.a3e93dcf.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/6.e2d4d96a.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/60.0cfe8778.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/61.48ab2616.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/62.44f735ea.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/63.0bfc6f0f.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/64.7785c0e5.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/65.b0c92212.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/66.d61e758d.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/67.fe08374f.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/68.787475c6.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/69.ca681a6c.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/7.6ea3b354.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/70.9e19ac99.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/71.304e5946.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/72.cc9adc1c.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/73.5d6e8cfa.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/74.48b5b8da.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/75.ae563bbf.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/76.5f05336a.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/77.38705786.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/78.3c9b2f38.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/79.b39e10db.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/8.1c994733.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/80.7933b8a9.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/81.17c4e023.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/82.ff8a25ed.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/83.8ff75adb.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/84.29d7cb9e.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/85.9a3b7936.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/86.88d88d3d.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/87.c9311269.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/88.bb4db4ce.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/89.b71072b5.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/9.74f2cd64.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/90.59939a3b.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/91.6b2d9529.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/92.3452ed84.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/93.5a1c587a.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/94.9f285282.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/95.e96ceb1b.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/96.44b7f063.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/97.03ff7ad0.js"><link rel="prefetch" href="/MyWebNote.org/assets/js/99.a3e97b24.js">
    <link rel="stylesheet" href="/MyWebNote.org/assets/css/0.styles.f56ec604.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/MyWebNote.org/" class="home-link router-link-active"><!----> <span class="site-name">前端学习</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/MyWebNote.org/note/" class="nav-link router-link-active">前端笔记</a></div><div class="nav-item"><a href="http://blog.saiki.xyz/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/Saikikoko/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/MyWebNote.org/note/" class="nav-link router-link-active">前端笔记</a></div><div class="nav-item"><a href="http://blog.saiki.xyz/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/Saikikoko/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>HTML/CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS3</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>H5</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>nodejs</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>其他</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/MyWebNote.org/note/other/01-Git.html" class="sidebar-link">Git</a></li><li><a href="/MyWebNote.org/note/other/02-Less语法.html" class="sidebar-link">Less语法</a></li><li><a href="/MyWebNote.org/note/other/03-Nginx学习.html" class="active sidebar-link">Nginx学习</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#nginx学习" class="sidebar-link">Nginx学习</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#初始nginx和环境准备" class="sidebar-link">初始Nginx和环境准备</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#nginx的快速搭建" class="sidebar-link">Nginx的快速搭建</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#nginx基本配置文件详解" class="sidebar-link">Nginx基本配置文件详解</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#nginx服务启动、停止、重启" class="sidebar-link">Nginx服务启动、停止、重启</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#_404页面设置" class="sidebar-link">404页面设置</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#nginx访问权限设置" class="sidebar-link">nginx访问权限设置</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#nginx设置虚拟主机" class="sidebar-link">Nginx设置虚拟主机</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#nginx反向代理" class="sidebar-link">Nginx反向代理</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#nginx适配pc或移动设备" class="sidebar-link">Nginx适配PC或移动设备</a></li><li class="sidebar-sub-header"><a href="/MyWebNote.org/note/other/03-Nginx学习.html#nginx的gzip压缩配置" class="sidebar-link">Nginx的Gzip压缩配置</a></li></ul></li></ul></li><li><a href="/MyWebNote.org/note/other/04-切图.html" class="sidebar-link">切图</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="nginx学习"><a href="#nginx学习" aria-hidden="true" class="header-anchor">#</a> Nginx学习</h2> <h3 id="初始nginx和环境准备"><a href="#初始nginx和环境准备" aria-hidden="true" class="header-anchor">#</a> 初始Nginx和环境准备</h3> <blockquote><p>&quot;Nginx是一款轻量级的HTTP服务器，采用事件驱动的异步非阻塞处理方式框架，这让其具有极好的IO性能，时常用于服务端的反向代理和负载均衡。&quot;</p></blockquote> <p>环境：阿里云ECS</p> <p><strong>使用yum安装必要程序</strong></p> <div class="language-shell extra-class"><pre class="language-text"><code>yum -y install gcc gcc-c++ autoconf pcre-devel make automake
yum -y install wget httpd-tools vim
</code></pre></div><ol><li><p>在根路径下新建一个<code>Nginx</code>的文件夹</p></li> <li><p>在<code>Nginx</code>文件夹下再另外建立<code>app</code>,<code>backup</code>,<code>download</code>,<code>logs</code>,<code>work</code>文件夹</p></li></ol> <h3 id="nginx的快速搭建"><a href="#nginx的快速搭建" aria-hidden="true" class="header-anchor">#</a> Nginx的快速搭建</h3> <ol><li><p>查看yum是否已经存在，如果出现一长串列表说明yum源是存在的</p> <div class="language-shell extra-class"><pre class="language-text"><code>yum list | grep nginx
</code></pre></div></li> <li><p>默认yum是1.1.12版本，可以自己配置yum的源，下面是官网提供的源配置选项</p> <div class="language- extra-class"><pre class="language-text"><code>[nginx]
name=nginx repo
baseurl=http://nginx.org/packages/OS/OSRELEASE/$basearch/
gpgcheck=0
enabled=1
</code></pre></div></li> <li><p>复制以上代码，在终端输入</p> <div class="language-shell extra-class"><pre class="language-text"><code>vim /etc/yum.repos.d/nginx.repo
</code></pre></div></li> <li><p>将以上代码复制进去，然后修改<code>baseurl</code>选项(主要是修改对应的操作系统和版本号)</p> <div class="language-vim extra-class"><pre class="language-vim"><code>baseurl<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>nginx<span class="token operator">.</span>org<span class="token operator">/</span>packages<span class="token operator">/</span>centos<span class="token operator">/</span><span class="token number">7</span><span class="token operator">/</span>$basearch<span class="token operator">/</span>
</code></pre></div></li> <li><p>退出保存文件后，使用yum命令进行安装</p> <div class="language-shell extra-class"><pre class="language-text"><code>yum install nginx
</code></pre></div></li> <li><p>安装完成后使用命令查看版本号，如果出现对应的版本号，则说明安装成功</p> <div class="language-shell extra-class"><pre class="language-text"><code>nginx -v
</code></pre></div><p><img src="C:%5CUsers%5Cshengbiao%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1549118415777.png" alt="1549118415777"></p></li></ol> <h3 id="nginx基本配置文件详解"><a href="#nginx基本配置文件详解" aria-hidden="true" class="header-anchor">#</a> Nginx基本配置文件详解</h3> <p><strong>查看Nginx的安装目录</strong></p> <div class="language-shell extra-class"><pre class="language-text"><code>rpm -ql nginx
</code></pre></div><p><strong>nginx.conf文件详解</strong></p> <p>nginx.conf文件是Nginx总配置文件，使用以下命令打开</p> <div class="language-shell extra-class"><pre class="language-text"><code>cd /etc/nginx
vim nginx.conf
</code></pre></div><p>下面是文件的详细注释：</p> <div class="language-js extra-class"><pre class="language-js"><code>#运行用户，默认即是nginx，可以不进行设置
user  nginx<span class="token punctuation">;</span>
#Nginx进程，一般设置为和<span class="token constant">CPU</span>核数一样
worker_processes  <span class="token number">1</span><span class="token punctuation">;</span>   
#错误日志存放目录
error_log  <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>error<span class="token punctuation">.</span>log warn<span class="token punctuation">;</span>
#进程pid存放位置
pid        <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token punctuation">.</span>pid<span class="token punctuation">;</span>
events <span class="token punctuation">{</span>
    worker_connections  <span class="token number">1024</span><span class="token punctuation">;</span> # 单个后台进程的最大并发数
<span class="token punctuation">}</span>
http <span class="token punctuation">{</span>
    include       <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>mime<span class="token punctuation">.</span>types<span class="token punctuation">;</span>   #文件扩展名与类型映射表
    default_type  application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>  #默认文件类型
    #设置日志模式
    log_format  main  <span class="token string">'$remote_addr - $remote_user [$time_local] &quot;$request&quot; '</span>
                      <span class="token string">'$status $body_bytes_sent &quot;$http_referer&quot; '</span>
                      <span class="token string">'&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;'</span><span class="token punctuation">;</span>
    access_log  <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>access<span class="token punctuation">.</span>log  main<span class="token punctuation">;</span>   #nginx访问日志存放位置
    sendfile        on<span class="token punctuation">;</span>   #开启高效传输模式
    #tcp_nopush     on<span class="token punctuation">;</span>    #减少网络报文段的数量
    keepalive_timeout  <span class="token number">65</span><span class="token punctuation">;</span>  #保持连接的时间，也叫超时时间
    #gzip  on<span class="token punctuation">;</span>  #开启gzip压缩
    include <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token punctuation">.</span>d<span class="token comment">/*.conf; #包含的子配置项位置和文件
</span></code></pre></div><p><strong>/etc/nginx/conf.d/*.conf目录下<code>\*conf</code>类型文件配置项详解</strong></p> <div class="language-shell extra-class"><pre class="language-text"><code>cd /ect/nginx/conf.d
vim default.conf
</code></pre></div><p>该目录下，一个文件代表一个虚拟主机</p> <p>默认<code>default.conf</code>文件讲解</p> <div class="language-js extra-class"><pre class="language-js"><code>server <span class="token punctuation">{</span>
    listen       <span class="token number">80</span><span class="token punctuation">;</span>   #配置监听端口
    server_name  localhost<span class="token punctuation">;</span>  <span class="token comment">//配置域名</span>
    #charset koi8<span class="token operator">-</span>r<span class="token punctuation">;</span>     
    #access_log  <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>host<span class="token punctuation">.</span>access<span class="token punctuation">.</span>log  main<span class="token punctuation">;</span>
    location <span class="token operator">/</span> <span class="token punctuation">{</span>
        root   <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token punctuation">;</span>     #服务默认启动目录
        index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>    #默认访问文件
    <span class="token punctuation">}</span>
    #error_page  <span class="token number">404</span>              <span class="token operator">/</span><span class="token number">404.</span>html<span class="token punctuation">;</span>   # 配置<span class="token number">404</span>页面
    # redirect server error pages to the <span class="token keyword">static</span> page <span class="token operator">/</span><span class="token number">50</span>x<span class="token punctuation">.</span>html
    #
    error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  <span class="token operator">/</span><span class="token number">50</span>x<span class="token punctuation">.</span>html<span class="token punctuation">;</span>   #错误状态码的显示页面，配置后需要重启
    location <span class="token operator">=</span> <span class="token operator">/</span><span class="token number">50</span>x<span class="token punctuation">.</span>html <span class="token punctuation">{</span>
        root   <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    # proxy the <span class="token constant">PHP</span> scripts to Apache listening on <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">80</span>
    #
    #location <span class="token operator">~</span> \<span class="token punctuation">.</span>php$ <span class="token punctuation">{</span>
    #    proxy_pass   http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">;</span>
    #<span class="token punctuation">}</span>
    # pass the <span class="token constant">PHP</span> scripts to FastCGI server listening on <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">9000</span>
    #
    #location <span class="token operator">~</span> \<span class="token punctuation">.</span>php$ <span class="token punctuation">{</span>
    #    root           html<span class="token punctuation">;</span>
    #    fastcgi_pass   <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">9000</span><span class="token punctuation">;</span>
    #    fastcgi_index  index<span class="token punctuation">.</span>php<span class="token punctuation">;</span>
    #    fastcgi_param  <span class="token constant">SCRIPT_FILENAME</span>  <span class="token operator">/</span>scripts$fastcgi_script_name<span class="token punctuation">;</span>
    #    include        fastcgi_params<span class="token punctuation">;</span>
    #<span class="token punctuation">}</span>
    # deny access to <span class="token punctuation">.</span>htaccess files<span class="token punctuation">,</span> <span class="token keyword">if</span> Apache's document root
    # concurs <span class="token keyword">with</span> nginx's one
    #
    #location <span class="token operator">~</span> <span class="token operator">/</span>\<span class="token punctuation">.</span>ht <span class="token punctuation">{</span>
    #    deny  all<span class="token punctuation">;</span>
    #<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="nginx服务启动、停止、重启"><a href="#nginx服务启动、停止、重启" aria-hidden="true" class="header-anchor">#</a> Nginx服务启动、停止、重启</h3> <p><strong>启动Nginx服务：</strong></p> <ol><li><p>nginx直接启动</p> <div class="language-shell extra-class"><pre class="language-text"><code>nginx
</code></pre></div></li> <li><p>使用Linux命令启动</p> <div class="language-shell extra-class"><pre class="language-text"><code>systemctl start nginx.service
</code></pre></div></li></ol> <p><strong>查看服务：</strong></p> <div class="language-shell extra-class"><pre class="language-text"><code>ps aux | grep nginx
</code></pre></div><p><img src="C:%5CUsers%5Cshengbiao%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1549119968809.png" alt="1549119968809"></p> <p>如图显示则说明，nginx服务启动成功</p> <p><strong>停止Nginx服务：</strong></p> <ol><li><p>立即停止服务，无论进程是否在工作，都直接关闭服务</p> <div class="language-shell extra-class"><pre class="language-text"><code>nginx -s stop
</code></pre></div></li> <li><p>从容停止服务，等待进程完成工作后，停止服务</p> <div class="language-shell extra-class"><pre class="language-text"><code>nginx -s quit
</code></pre></div></li> <li><p>killall杀死所有进程</p></li> <li><p>systemctl停止</p> <div class="language-shell extra-class"><pre class="language-text"><code>systemctl stop nginx.service
</code></pre></div></li></ol> <p><strong>重启nginx服务：</strong></p> <div class="language-shell extra-class"><pre class="language-text"><code>systemctl restart nginx.service
</code></pre></div><p><strong>重新载入配置文件</strong></p> <p>在重新编写或者修改Nginx的配置文件后，都需要作以下重载</p> <div class="language-shell extra-class"><pre class="language-text"><code>nginx -s reload
</code></pre></div><p><strong>查看端口号</strong></p> <div class="language-shell extra-class"><pre class="language-text"><code>netstat -tlnp
</code></pre></div><p>该命令可以查看端口的占用情况</p> <h3 id="_404页面设置"><a href="#_404页面设置" aria-hidden="true" class="header-anchor">#</a> 404页面设置</h3> <ol><li>编辑配置文件<code>/etc/nginx/conf.d/default.conf</code></li></ol> <div class="language-conf extra-class"><pre class="language-text"><code>error_page   404  /404.html;
</code></pre></div><ol start="2"><li><p>编写404页面</p></li> <li><p>首先进入<code>/usr/share/nginx/html</code></p></li> <li><p><code>vim 404.html</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>utf-8<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>404<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
  <span class="token selector">div</span><span class="token punctuation">{</span>
     <span class="token property">width</span><span class="token punctuation">:</span> 25%<span class="token punctuation">;</span>
     <span class="token property">margin</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>404页面找不到了<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>重启nginx服务</p></li></ol> <h3 id="nginx访问权限设置"><a href="#nginx访问权限设置" aria-hidden="true" class="header-anchor">#</a> nginx访问权限设置</h3> <div class="language-js extra-class"><pre class="language-js"><code> location <span class="token operator">/</span> <span class="token punctuation">{</span>
        allow  <span class="token number">45.76</span><span class="token number">.202</span><span class="token number">.231</span><span class="token punctuation">;</span>
        deny   all<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>该配置表示除了<code>45.76.202.231</code>，其他的ip都不能访问该服务器的任意目录，allow和deny谁在前谁的优先级高</p> <h4 id="精确比配-访问权限配置"><a href="#精确比配-访问权限配置" aria-hidden="true" class="header-anchor">#</a> 精确比配<code>=</code>访问权限配置</h4> <div class="language-js extra-class"><pre class="language-js"><code>location <span class="token operator">=</span><span class="token operator">/</span>img<span class="token punctuation">{</span>
allow all<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
location <span class="token operator">=</span><span class="token operator">/</span>admin<span class="token punctuation">{</span>
deny all<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>设置完后，该网站<code>img</code>目录所有用户都可以访问，<code>admin</code>目录所有用户都不可以访问</p> <h4 id="正则（模糊）匹配-访问权限配置"><a href="#正则（模糊）匹配-访问权限配置" aria-hidden="true" class="header-anchor">#</a> 正则（模糊）匹配<code>~</code>访问权限配置</h4> <div class="language-js extra-class"><pre class="language-js"><code>location <span class="token operator">~</span>\<span class="token punctuation">.</span>php$ <span class="token punctuation">{</span>
    deny all<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>不能访问<code>.php</code>文件</p> <h3 id="nginx设置虚拟主机"><a href="#nginx设置虚拟主机" aria-hidden="true" class="header-anchor">#</a> Nginx设置虚拟主机</h3> <h4 id="基于端口号配置虚拟主机"><a href="#基于端口号配置虚拟主机" aria-hidden="true" class="header-anchor">#</a> <strong>基于端口号配置虚拟主机</strong></h4> <ol><li><code>etc/nginx/conf.d/</code>目录下新建配置文件<code>3000.conf</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>server<span class="token punctuation">{</span>
        listen <span class="token number">3000</span><span class="token punctuation">;</span>
        server_name localhost<span class="token punctuation">;</span>
        root <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token operator">/</span>html3000<span class="token punctuation">;</span>
        index index<span class="token punctuation">.</span>html<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li><p>在<code>usr/share/nginx/html/html3000/</code>目录下新建<code>index.html</code>文件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>
    Welcome to port 3000
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>重启服务</p></li></ol> <h4 id="基于ip设置虚拟主机"><a href="#基于ip设置虚拟主机" aria-hidden="true" class="header-anchor">#</a> 基于ip设置虚拟主机</h4> <p>只需改变server选项中的<code>server_name</code>即可</p> <div class="language-js extra-class"><pre class="language-js"><code>server<span class="token punctuation">{</span>
        listen <span class="token number">80</span><span class="token punctuation">;</span>
        server_name <span class="token number">112.74</span><span class="token number">.164</span><span class="token number">.244</span><span class="token punctuation">;</span>
        root <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token operator">/</span>html8001<span class="token punctuation">;</span>
        index index<span class="token punctuation">.</span>html<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="使用域名设置虚拟主机"><a href="#使用域名设置虚拟主机" aria-hidden="true" class="header-anchor">#</a> 使用域名设置虚拟主机</h4> <p>和ip类似修改server选项中的<code>server_name</code>即可</p> <h3 id="nginx反向代理"><a href="#nginx反向代理" aria-hidden="true" class="header-anchor">#</a> Nginx反向代理</h3> <ul><li>安全 隐藏真实服务器</li> <li>负载均衡</li></ul> <p>修改配置文件<code>3000.conf</code></p> <div class="language-js extra-class"><pre class="language-js"><code>server<span class="token punctuation">{</span>
        listen <span class="token number">80</span><span class="token punctuation">;</span>
        server_name blog<span class="token punctuation">.</span>saiki<span class="token punctuation">.</span>xyz<span class="token punctuation">;</span>
        location <span class="token operator">/</span> <span class="token punctuation">{</span>
               proxy_pass http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>saiki<span class="token punctuation">.</span>xyz<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>设置完以后，用户访问<code>http://blog.saiki.xyz</code>，则会访问<code>http://saiki.xyz</code></p> <ul><li>proxy_set_header :在将客户端请求发送给后端服务器之前，更改来自客户端的请求头信息。</li> <li>proxy_connect_timeout:配置Nginx与后端代理服务器尝试建立连接的超时时间。</li> <li>proxy_read_timeout : 配置Nginx向后端服务器组发出read请求后，等待相应的超时时间。</li> <li>proxy_send_timeout：配置Nginx向后端服务器组发出write请求后，等待相应的超时时间。</li> <li>proxy_redirect :用于修改后端服务器返回的响应头中的Location和Refresh。</li></ul> <h3 id="nginx适配pc或移动设备"><a href="#nginx适配pc或移动设备" aria-hidden="true" class="header-anchor">#</a> Nginx适配PC或移动设备</h3> <p>通过变量<code>$http_user_agent</code>获取<code>userAgent</code>，判断用户目前处于移动端还是pc端</p> <p>操作步骤如下：</p> <ol><li><p>在<code>/usr/share/nginx/</code>目录下新建两个文件夹，分别为：pc和mobile目录</p> <div class="language-vim extra-class"><pre class="language-vim"><code><span class="token keyword">cd</span> <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx
mkdir <span class="token keyword">pc</span>
mkdir mobile
</code></pre></div></li> <li><p>在pc和miblic目录下，新建两个index.html文件，文件里下面内容</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>I am pc!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>I am mobile!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>进入<code>etc/nginx/conf.d</code>目录下，修改3000.conf文件，改为下面的形式:</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>server<span class="token punctuation">{</span>
     listen <span class="token number">80</span><span class="token punctuation">;</span>
     server_name blog<span class="token operator">.</span>saiki<span class="token operator">.</span>xyz<span class="token punctuation">;</span>
     location <span class="token operator">/</span> <span class="token punctuation">{</span>
      root <span class="token string regex">/usr/</span>share<span class="token string regex">/nginx/</span>pc<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">$</span>http_user_agent <span class="token operator">~</span><span class="token operator">*</span> <span class="token string">'(Android|webOS|iPhone|iPod|BlackBerry)'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         root <span class="token string regex">/usr/</span>share<span class="token string regex">/nginx/</span>mobile<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      index index<span class="token operator">.</span>html<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h3 id="nginx的gzip压缩配置"><a href="#nginx的gzip压缩配置" aria-hidden="true" class="header-anchor">#</a> Nginx的Gzip压缩配置</h3> <p><strong>gzip的配置项</strong></p> <p>Nginx提供了专门的gzip模块，并且模块中的指令非常丰富。</p> <ul><li>gzip : 该指令用于开启或 关闭gzip模块。</li> <li>gzip_buffers : 设置系统获取几个单位的缓存用于存储gzip的压缩结果数据流。</li> <li>gzip_comp_level : gzip压缩比，压缩级别是1-9，1的压缩级别最低，9的压缩级别最高。压缩级别越高压缩率越大，压缩时间越长。</li> <li>gzip_disable : 可以通过该指令对一些特定的User-Agent不使用压缩功能。</li> <li>gzip_min_length:设置允许压缩的页面最小字节数，页面字节数从相应消息头的Content-length中进行获取。</li> <li>gzip_http_version：识别HTTP协议版本，其值可以是1.1.或1.0.</li> <li>gzip_proxied : 用于设置启用或禁用从代理服务器上收到相应内容gzip压缩。</li> <li>gzip_vary : 用于在响应消息头中添加Vary：Accept-Encoding,使代理服务器根据请求头中的Accept-Encoding识别是否启用gzip压缩。</li></ul> <p><strong>gzip最简单的配置</strong></p> <div class="language-applescript extra-class"><pre class="language-applescript"><code>http <span class="token punctuation">{</span>
   .....
    gzip <span class="token keyword">on</span>;
    gzip_types <span class="token class builtin">text</span><span class="token operator">/</span>plain <span class="token class builtin">application</span><span class="token operator">/</span>javascript <span class="token class builtin">text</span><span class="token operator">/</span>css;
   .....
<span class="token punctuation">}</span>
</code></pre></div><p><code>gzip on</code>是启用gizp模块，下面的一行是用于在客户端访问网页时，对文本、JavaScript 和CSS文件进行压缩输出。</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/MyWebNote.org/assets/js/app.f2fe0c7f.js" defer></script><script src="/MyWebNote.org/assets/js/98.1e915b70.js" defer></script>
  </body>
</html>
